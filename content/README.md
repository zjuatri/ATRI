# Content Scripts æ–‡ä»¶ç»“æ„è¯´æ˜

## ğŸ“ æ–‡ä»¶ç»„ç»‡

åŸæ¥çš„ `content.js` (1643 è¡Œ) å·²ç»è¢«æ‹†åˆ†æˆ 6 ä¸ªæ¨¡å—åŒ–æ–‡ä»¶ï¼š

### 1. **interceptor.js** (åŸæœ‰æ–‡ä»¶)
- **ä½œç”¨**: æ³¨å…¥é¡µé¢æ‹¦æˆªå™¨è„šæœ¬
- **èŒè´£**: åŠ è½½ `page-interceptor.js` åˆ°é¡µé¢å…¨å±€ä½œç”¨åŸŸ

### 2. **utils.js** (~100 è¡Œ)
- **ä½œç”¨**: å·¥å…·å‡½æ•°å’Œè¾…åŠ©æ–¹æ³•
- **åŒ…å«**:
  - `SUPPORTED_DOMAINS` - æ”¯æŒçš„åŸŸååˆ—è¡¨
  - `isSupportedDomain()` - æ£€æŸ¥åŸŸå
  - `isPageType()` - æ£€æŸ¥é¡µé¢ç±»å‹
  - `extractExamParams()` - æå–URLå‚æ•°
  - `waitForElement()` - ç­‰å¾…å…ƒç´ å‡ºç°
  - `delay()` - å»¶è¿Ÿæ‰§è¡Œ
  - `safeSendMessage()` - å®‰å…¨å‘é€Chromeæ¶ˆæ¯

### 3. **ui.js** (~200 è¡Œ)
- **ä½œç”¨**: UI ç›¸å…³åŠŸèƒ½
- **åŒ…å«**:
  - `createDisplayBox()` - åˆ›å»ºæµ®çª—
  - `updateDisplayBoxContent()` - æ›´æ–°æµ®çª—å†…å®¹
  - `showNotification()` - æ˜¾ç¤ºé€šçŸ¥æ¶ˆæ¯
  - æ‹–åŠ¨ç›¸å…³å‡½æ•°
  - CSS åŠ¨ç”»æ ·å¼

### 4. **auto-answer.js** (~300 è¡Œ)
- **ä½œç”¨**: è‡ªåŠ¨ç­”é¢˜æ ¸å¿ƒé€»è¾‘
- **åŒ…å«**:
  - `detectInputElements()` - æ£€æµ‹è¾“å…¥æ¡†
  - `autoAnswerInExamPage()` - è‡ªåŠ¨ç­”é¢˜ä¸»æµç¨‹
  - `detectAndFillAnswer()` - æ£€æµ‹å¹¶å¡«å…¥ç­”æ¡ˆ
  - `fillAnswerOnly()` - å¡«å…¥ç­”æ¡ˆ
  - `clickNextQuestion()` - ç‚¹å‡»ä¸‹ä¸€é¢˜
  - `clickSubmitButton()` - ç‚¹å‡»æäº¤
  - `startAutoAnswering()` - å¼€å§‹ç­”é¢˜
  - `stopAutoAnswering()` - åœæ­¢ç­”é¢˜

### 5. **page-handlers.js** (~300 è¡Œ)
- **ä½œç”¨**: å¤„ç†ä¸åŒé¡µé¢çš„ç‰¹å®šé€»è¾‘
- **åŒ…å«**:
  - `findAndClickNextUncompleted()` - mastery é¡µé¢ï¼šæŸ¥æ‰¾æœªå®Œæˆé¢˜ç›®
  - `handlePointOfMasteryPage()` - pointOfMastery é¡µé¢å¤„ç†
  - `handleUserAnswersData()` - examAnalysis é¡µé¢ï¼šå¤„ç†ç­”é¢˜åˆ†æ
  - `clickSubmitInAnalysisPage()` - examAnalysis é¡µé¢ï¼šç‚¹å‡»æäº¤

### 6. **content-main.js** (~250 è¡Œ)
- **ä½œç”¨**: ä¸»å…¥å£æ–‡ä»¶
- **åŒ…å«**:
  - å…¨å±€çŠ¶æ€å˜é‡åˆå§‹åŒ–
  - æ¶ˆæ¯ç›‘å¬ (æ¥è‡ªæ‹¦æˆªå™¨å’Œæ‰©å±•)
  - URL å˜åŒ–ç›‘å¬
  - é¡µé¢åˆå§‹åŒ–é€»è¾‘
  - çŠ¶æ€æ¢å¤

## ğŸ”„ åŠ è½½é¡ºåº

åœ¨ `manifest.json` ä¸­ï¼Œè„šæœ¬æŒ‰ä»¥ä¸‹é¡ºåºåŠ è½½ï¼š

```json
"js": [
  "content/interceptor.js",      // 1. æ³¨å…¥æ‹¦æˆªå™¨
  "content/utils.js",            // 2. å·¥å…·å‡½æ•° (å…¶ä»–æ¨¡å—ä¾èµ–)
  "content/ui.js",               // 3. UI æ¨¡å—
  "content/auto-answer.js",      // 4. ç­”é¢˜é€»è¾‘
  "content/page-handlers.js",    // 5. é¡µé¢å¤„ç†
  "content/content-main.js"      // 6. ä¸»å…¥å£ (è°ƒç”¨å…¶ä»–æ¨¡å—)
]
```

## ğŸ“Š æ¨¡å—ä¾èµ–å…³ç³»

```
content-main.js (ä¸»å…¥å£)
    â”œâ”€â”€ utils.js (å·¥å…·å‡½æ•°)
    â”œâ”€â”€ ui.js (UI æ˜¾ç¤º)
    â”œâ”€â”€ auto-answer.js (ç­”é¢˜é€»è¾‘)
    â”‚   â”œâ”€â”€ utils.js
    â”‚   â””â”€â”€ ui.js
    â””â”€â”€ page-handlers.js (é¡µé¢å¤„ç†)
        â”œâ”€â”€ utils.js
        â”œâ”€â”€ ui.js
        â””â”€â”€ auto-answer.js
```

## ğŸ¯ ä¼˜åŠ¿

1. **å¯ç»´æŠ¤æ€§**: æ¯ä¸ªæ–‡ä»¶èŒè´£å•ä¸€ï¼Œæ˜“äºç†è§£å’Œä¿®æ”¹
2. **å¯è¯»æ€§**: æ–‡ä»¶è¡Œæ•°æ§åˆ¶åœ¨ 100-300 è¡Œä¹‹é—´
3. **å¯æµ‹è¯•æ€§**: ç‹¬ç«‹æ¨¡å—ä¾¿äºå•å…ƒæµ‹è¯•
4. **å¯æ‰©å±•æ€§**: æ·»åŠ æ–°åŠŸèƒ½åªéœ€ä¿®æ”¹å¯¹åº”æ¨¡å—
5. **åä½œå‹å¥½**: å¤šäººå¯åŒæ—¶ç¼–è¾‘ä¸åŒæ¨¡å—

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **åŠ è½½é¡ºåºå¾ˆé‡è¦**: å¿…é¡»å…ˆåŠ è½½ `utils.js`ï¼Œå› ä¸ºå…¶ä»–æ¨¡å—ä¾èµ–å®ƒ
2. **å…¨å±€å˜é‡**: ä½¿ç”¨ `window.` å‰ç¼€æ¥å…±äº«çŠ¶æ€
3. **å‡½æ•°è°ƒç”¨**: æ¨¡å—é—´å¯ä»¥ç›´æ¥è°ƒç”¨å‡½æ•°ï¼ˆå·²åœ¨å…¨å±€ä½œç”¨åŸŸï¼‰
4. **Chrome API**: åªæœ‰ content script æ‰èƒ½è®¿é—® Chrome API

## ğŸ”§ æ—§æ–‡ä»¶å¤„ç†

åŸ `content/content.js` æ–‡ä»¶å·²è¢«æ‹†åˆ†ï¼Œå»ºè®®ï¼š
- ä¿ç•™ä½œä¸ºå¤‡ä»½ï¼ˆé‡å‘½åä¸º `content.js.backup`ï¼‰
- æˆ–è€…ç›´æ¥åˆ é™¤

## ğŸ“ æœªæ¥æ”¹è¿›

å¯ä»¥è€ƒè™‘è¿›ä¸€æ­¥ä¼˜åŒ–ï¼š
1. ä½¿ç”¨ ES6 æ¨¡å— (éœ€è¦é…ç½® type="module")
2. ä½¿ç”¨ TypeScript å¢åŠ ç±»å‹å®‰å…¨
3. ä½¿ç”¨æ‰“åŒ…å·¥å…· (webpack/rollup) è¿›è¡Œæ¨¡å—æ‰“åŒ…
